# Excel_CpUpdate2.py (엑셀 셀 비교 및 업데이트 - 데이터 정리 기능 포함)

지정된 엑셀 파일 내에서 특정 범위의 셀 값을 비교하고, 조건에 따라 셀의 값과 색상을 수정하는 기능을 제공

특히, **pandas** 라이브러리를 활용하여 셀의 데이터를 정리(clean)한 후 비교함으로써, 숫자형 데이터와 문자열 데이터를 보다 정확하게 비교

## 기능

- **데이터 클리닝 및 변환 (`clean_value` 함수):**
    - **불필요한 문자 제거:** 셀 값이 문자열일 경우, 공백이나 특수문자(`\xa0`, `\u200b`)를 제거하여 정리
    - **숫자 변환:** pandas의 `to_numeric` 함수를 사용해 숫자형으로 변환을 시도하며, 성공하면 소수점 6자리까지 반올림하여 반환
    - **문자열 비교:** 변환이 실패한 경우, 소문자로 변환한 문자열로 비교를 진행
- **셀 비교 및 업데이트 (`compare_and_update` 함수):**
    - **범위 지정:** 8행부터 373행까지, 3개의 컬럼 그룹(예: C~~E와 F~~H 또는 M~~O와 P~~R)을 대상으로 작업
    - **비교 작업:** 각 그룹 내에서 지정된 두 셀의 값을 `clean_value` 함수를 통해 정리 후 비교
    - **조건에 따른 처리:**
        - 값이 동일하면, 해당 셀을 **연두색**(`green_fill`)으로 표시
        - 값이 다르면, 오른쪽 그룹의 셀 값을 왼쪽 그룹의 셀로 복사하고 **주황색**(`orange_fill`)으로 표시
- **결과 저장:**
    
    모든 변경 사항은 `updated_excel2.xlsx`라는 새로운 파일로 저장
    

## 설치 및 사용 방법

### 1. 필수 라이브러리 설치

스크립트 실행 전, 필요한 라이브러리인 **openpyxl**과 **pandas**를 설치:

```bash
pip install openpyxl pandas
```

### 2. 파일 경로 및 시트명 설정

- `file_path` 변수를 수정하여 엑셀 파일의 경로를 지정
- `sheet_name` 변수를 수정하여 작업할 시트명을 지정

> 주의: 파일 경로 입력 시 역슬래시(\) 대신 슬래시(/)를 사용
> 

### 3. 스크립트 실행

Python 환경에서 스크립트를 실행하면, 지정된 범위의 셀 데이터를 비교하여 조건에 맞게 업데이트하며, 결과는 `updated_excel2.xlsx` 파일로 저장

## 주의 사항

- **범위 고정:** 비교할 셀 범위(행: 8~373, 컬럼 그룹: 3개)는 코드 내에 고정되어 있으므로, 필요에 따라 수정이 필요
- **데이터 정리 효과:** pandas를 사용한 숫자 변환 기능 덕분에 숫자 데이터 비교 시 소수점 오차를 줄이고, 문자열은 소문자로 통일하여 비교하므로 보다 정확한 결과를 얻을 수 있음